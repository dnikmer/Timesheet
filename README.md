# Timesheet Timer Application

Приложение для Windows 11, позволяющее вести учет времени по проектам и видам работ с сохранением данных в Excel.

## Возможности

- Выбор файла Excel (формат `.xlsx`) через проводник Windows.
- Загрузка проектов и видов работ из листа `Справочник` указанного файла.
- Таймер с кнопками **Запуск**, **Пауза**, **Стоп**.
- Автоматическая запись данных о выполненной работе в лист `Учет времени` с указанием даты, проекта, вида работы и продолжительности.
- Сохранение пути к Excel-файлу между запусками.

## Требования к Excel-файлу

- Лист `Справочник` должен содержать столбцы «Проект» и «Вид работы`. Первая строка может быть заголовком.
- Лист `Учет времени` должен существовать и содержать как минимум столбцы: `Дата`, `Проект`, `Вид работы`, `Длительность`. Новые записи добавляются в конец листа. Длительность записывается в формате Excel `Time` (например `0:30:00` для 30 минут).

## Запуск из исходников

1. Установите Python 3.11 или новее.
2. Создайте и активируйте виртуальное окружение:
   ```bash
   python -m venv .venv
   .venv\\Scripts\\activate  # Windows
   ```
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
4. Запустите приложение. Самый простой способ — воспользоваться вспомогательным
   скриптом, который автоматически добавляет каталог `src` в `PYTHONPATH`:
   ```bash
   python run_timesheet.py
   ```
   Если вы предпочитаете запускать через модуль, сначала убедитесь, что
   каталог `src` доступен Python (например, `set PYTHONPATH=%CD%\src` в этой
   консоли), а затем выполните:
   ```bash
   python -m timesheet_app
   ```

## Создание исполняемого файла

Для сборки автономного `.exe` используется [PyInstaller](https://pyinstaller.org/).

1. Установите PyInstaller (команда выполняется из активированного виртуального окружения):
   ```bash
   python -m pip install --upgrade pip
   python -m pip install pyinstaller
   ```
2. Выполните команду сборки. Использование `python -m PyInstaller` гарантирует запуск даже если папка `Scripts` не добавилась в `PATH`:
   ```bash
   python -m PyInstaller --noconfirm --onefile --name TimesheetTimer --windowed src/timesheet_app/app.py
   ```
3. Если PowerShell по-прежнему сообщает «Имя "pyinstaller" не распознано», убедитесь, что виртуальное окружение активно (`.venv\Scripts\Activate.ps1`). Затем повторите команды выше.
4. Готовый файл `TimesheetTimer.exe` будет находиться в каталоге `dist`.

## Создание установщика

Для формирования установщика можно воспользоваться [Inno Setup](https://jrsoftware.org/isinfo.php).

1. Скопируйте файл `TimesheetTimer.exe` в отдельную папку, например `installer\\app`.
2. Отредактируйте при необходимости файл `installer\\TimesheetTimer.iss` (см. ниже) и укажите путь к собранному `.exe`.
3. Откройте `.iss` файл в Inno Setup и соберите установщик (`Build > Compile`).
4. В настройках установщика по умолчанию используется каталог `C:\\Program Files\\TimeSheet`.

Файл сценария Inno Setup располагается в `installer/TimesheetTimer.iss` и готов к использованию.

## Используемые инструменты

- Python 3 (tkinter для графического интерфейса)
- [openpyxl](https://openpyxl.readthedocs.io/) для чтения и записи Excel-файлов
- PyInstaller (для упаковки в `.exe`)
- Inno Setup (для создания установочного файла)

## Структура проекта

```
Timesheet/
├── README.md
├── run_timesheet.py
├── requirements.txt
├── src/
│   └── timesheet_app/
│       ├── __init__.py
│       ├── __main__.py
│       ├── app.py
│       └── config.py
└── installer/
    └── TimesheetTimer.iss
```

## Настройка Excel

При первом запуске приложение попросит выбрать файл Excel. Путь сохраняется и используется при последующих запусках. Таймер можно запускать несколько раз подряд — каждая остановка добавляет новую строку в лист `Учет времени`.

Если структура книги не соответствует требованиям, приложение покажет сообщение об ошибке, и путь к файлу можно будет выбрать снова через меню **Файл → Выбрать файл Excel**.
